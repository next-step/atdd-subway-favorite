# 인증과 인가에 대한 적절한 책임 찾아주기(어떤 계층 혹은 객체에서 검증할 것인가)


웹 애플리케이션에서 인증(Authentication)과 인가(Authorization)는 보안을 유지하는 핵심 요소이다. 하지만 이 둘을 어느 계층에서 처리하는 것이 최적인지는 상당히 미묘한 문제가 있다.

### 인증 처리 위치: 필터 혹은 인터셉터

인증에서는 필터(Filter)나 인터셉터(Interceptor)가 자주 사용된다. 개인적으로 필터를 선호한다. 
두 관점 모두 인증 과정이 엔드포인트에 도달하기 전에 완료된다는 점에서 유사한 프로세스라고 생각한다. 

스프링 시큐리티의 프랙티스는 정답이 아닐 수도 있지만, 대부분의 경우 인증 과정은 가능한 한 빨리 완료되는 것이 좋은 것 같다.
그렇게 하면 API는 인증과 인가에 대해 크게 신경 쓰지 않고, 더 중요한 비즈니스 로직에 집중할 수 있기 때문이다.

### 인가 처리 위치: 스프링 컨텍스트 컨트롤러 이하의 비즈니스 계층

다만 인가의 경우, 스프링 컨텍스트의 컨트롤러 하위 계층에서 처리하는 것이 적절하다. 
만약 URL 기반으로 작동하는 경우, 필터에서 처리할 수도 있다. 이때, 인가 과정에서 데이터베이스(DB) 호출이 필요할 것인데, 필터에서 DB를 호출하는 것이 레이어드 아키텍처의 구성으로는 풀기 어려운 난제가 된다. 이때 클린 아키텍처에서 언급하는 어댑터(Adapter) 관점이 좋은 해결책을 제공할 수 있다고 생각한다.

하지만, 메서드 방식으로 인가를 구현하는 경우, 비즈니스를 담당하는 도메인 계층에서 처리하는 것이 더 적절하다.
이 방법은 비즈니스 로직과 보안 요구 사항이 밀접하게 연결되어 있을 때 특히 효과적이다.


### 인증과 인가의 적절한 책임 소재

요약하자면 인증은 대부분의 경우 필터나 인터셉터에서 처리하는 것이 바람직하며, 인가는 상황에 따라 달라질 수 있습니다.
어떤 경우에는 URL 기반의 인가가 필터에서 적절하게 처리될 수 있지만, 
복잡한 인가 요구 사항을 가진 시스템에서는 도메인 계층에서의 처리가 더 적합할 수 있다.
